!function(){"use strict";angular.module("angular-tour",["angular-tour.tpls","angular-tour.tour"]),angular.module("angular-tour.tpls",["tour/tour.tpl.html"]),angular.module("tour/tour.tpl.html",[]).run(["$templateCache",function(a){a.put("tour/tour.tpl.html",'<div class="tour-tip">\n	<span class="tour-arrow tt-{{ ttPlacement + \'-\' + ttAlign }}-border"></span>\n    <span class="tour-arrow tt-{{ ttPlacement + \'-\' + ttAlign }}"></span>\n	<div class="tour-tip-header">\n		<a ng-click="closeTour()" class="tour-close-tip">Ã—</a>\n	</div>\n	<div class="tour-tip-body">\n		<div class="tour-content-wrapper">\n	        <p ng-bind-html="ttContent"></p>\n	    </div>\n	</div>\n	<div class="tour-tip-footer">\n		<a ng-if="!ttFirst" ng-click="setPrevStep()" ng-bind-html="ttBackLabel" class="small button tour-prev-tip"></a>\n		<a ng-if="!ttLast" ng-click="setNextStep()" ng-bind-html="ttNextLabel" class="small button tour-next-tip"></a>\n		<a ng-if="ttLast" ng-click="setNextStep()" ng-bind-html="ttFinishLabel" class="small button tour-last-tip"></a>\n	</div>\n	    \n</div>')}]),angular.module("angular-tour.tour",[]).constant("tourConfig",{placement:"top",animation:!0,nextLabel:"Next",backLabel:"Back",finishLabel:"Finish",scrollSpeed:500,offset:28,frame:"body"}).controller("TourController",["$scope","$rootScope","$attrs","$parse","orderedList",function(a,b,c,d,e){var f=this,g=d(c.step);f.postTourCallback=angular.noop,f.postStepCallback=angular.noop,f.currentStep=0,f.newList=function(){f.steps=e()},f.newList(),f.select=function(b){f.unselectAllSteps(),b&&(f.currentStep=b.index,b.ttOpen=!0,a.$parent.$eval(b.ttPostStep))},f.addStep=function(a){angular.isNumber(a.index)&&!isNaN(a.index)?f.steps.set(a.index,a):f.steps.push(a)},f.unselectAllSteps=function(){f.steps.forEach(function(a){a.ttOpen=!1})},f.cancelTour=function(){f.unselectAllSteps(),f.postTourCallback(),f.currentStep=0,a.tourActive=!1},f.setStep=function(b){g.assign(a.$parent,b.index),f.currentStep=b.index,f.select(b)},b.openTour=function(){var b=f.steps.get(0);return b?(f.select(0),void(a.tourActive=!0)):void 0},b.closeTour=function(){f.cancelTour()},b.ttNextStep=function(a){var a=(a||f.currentStep)+1;if(a==f.steps.getCount())return void f.cancelTour();var c=f.steps.get(a);c?f.setStep(c):b.ttNextStep(a)},b.ttPrevStep=function(a){var a=(a||f.currentStep)-1;if(0>a)return void f.cancelTour();var c=f.steps.get(a);c?f.setStep(c):b.ttPrevStep(a)}}]).directive("tour",["$rootScope",function(a){return{controller:"TourController",restrict:"EA",scope:!0,link:function(b,c,d,e){if(!angular.isDefined(d.step))throw"The <tour> directive requires a `step` attribute to bind the current step to.";b.$on(d.rebuildOn?d.rebuildOn:"$locationChangeStart",function(){e.newList()}),e.postTourCallback=function(){angular.isDefined(d.postTour)&&b.$parent.$eval(d.postTour)},b.setNextStep=function(){a.ttNextStep()},b.setPrevStep=function(){a.ttPrevStep()}}}}]).directive("tourtip",["$window","$compile","$interpolate","$parse","$timeout","$sce","scrollTo","tourConfig",function(a,b,c,d,e,f,g,h){var i=(c.startSymbol(),c.endSymbol(),"<div tour-popup></div>");return{require:"^tour",restrict:"EA",scope:!0,compile:function(){var c=angular.element(a);return{pre:function(a,b,c,d){c.$observe("tourtip",function(b){a.ttContent=f.trustAsHtml(b)}),c.$observe("tourtipPlacement",function(b){a.ttPlacement=b||h.placement}),c.$observe("tourtipNextLabel",function(b){a.ttNextLabel=f.trustAsHtml(b||h.nextLabel)}),c.$observe("tourtipBackLabel",function(b){a.ttBackLabel=f.trustAsHtml(b||h.backLabel)}),c.$observe("tourtipFinishLabel",function(b){a.ttFinishLabel=f.trustAsHtml(b||h.finishLabel)}),c.$observe("tourtipOffsetTop",function(b){a.ttOffsetTop=parseInt(b,10)||0}),c.$observe("tourtipOffsetLeft",function(b){a.ttOffsetLeft=parseInt(b,10)||0}),c.$observe("tourtipFrame",function(b){a.ttFrame=b||h.frame}),c.$observe("postStep",function(b){a.ttPostStep=b||"angular.noop()"}),c.$observe("tourtipAlign",function(b){a.ttAlign="top bottom".match(a.ttPlacement)?b||"left":b||"top"}),a.ttOpen=!1,a.ttAnimation=h.animation,a.index=parseInt(c.tourtipStep,10),a.isFirstStep=function(){var b=parseInt(a.index.toString(),10);for(d.steps.getCount();b>=0;)if(b-=1,d.steps.get(b))return!1;return!0},a.isLastStep=function(){for(var b=parseInt(a.index.toString(),10),c=d.steps.getCount();c>b;)if(b+=1,d.steps.get(b))return!1;return!0},d.addStep(a)},post:function(a,d){function f(){if(a.ttContent){a.ttFirst=a.isFirstStep(),a.ttLast=a.isLastStep(),a.ttAnimation?m.fadeIn():m.css({display:"block"}),l=k.closest(a.ttFrame),$("body").append(m),c.bind("resize."+a.$id,n),l.bind("scroll",n),o(k,m);var b={duration:h.speed,easing:"swing"};b.offsetTop="top"==a.ttPlacement||"bottom"==a.ttAlign?m.height()+(l.offset()?l.offset().top+100:100):l.offset()?l.offset().top+100:100,g(l,k,b)}}function j(){l=k.closest(a.ttFrame),m.detach(),c.unbind("resize."+a.$id,n),l.unbind("scroll",n)}var k,l,m=b(i)(a),n=function(){o(k,m)};k=d.children().eq(0).length>0?d.children().eq(0):d,l=k.closest(a.ttFrame),e(function(){a.$watch("ttOpen",function(a){a?f():j()})},500);var o=function(b,c){var d,e,f,g,h,i,j;switch(d=b[0].getBoundingClientRect(),e=c.width(),f=c.height(),i=b.width(),h=b.height(),j=$(".tour-arrow")[0].getBoundingClientRect().height,a.ttPlacement){case"right":case"left":g="top"==a.ttAlign?{top:d.top-(f>h?h/2+j:0)+a.ttOffsetTop}:{top:d.top-(f>h?f-h/2-j:f)+a.ttOffsetTop},g.left="right"==a.ttPlacement?d.left+i+a.ttOffsetLeft:d.left-e-a.ttOffsetLeft;break;case"bottom":case"top":g="left"==a.ttAlign?{left:d.left-(e>i?j:0)+a.ttOffsetLeft}:{left:d.left-(e>i?e+2*j:e)+a.ttOffsetLeft},g.top="bottom"==a.ttPlacement?d.top+h+a.ttOffsetTop:d.top-f-a.ttOffsetTop}g.top+="px",g.left+="px",c.css(g)};a.$on("$destroy",function(){c.unbind("resize."+a.$id,n),l.unbind("scroll",n),m.remove()})}}}}}]).directive("tourPopup",function(){return{replace:!0,templateUrl:"tour/tour.tpl.html",scope:!0,restrict:"EA",link:function(){}}}).factory("orderedList",function(){var a=function(){this.map={},this._array=[]};a.prototype.set=function(a,b){if(angular.isNumber(a))if(a in this.map)this.map[a]=b;else{if(a<this._array.length){var c=a-1>0?a-1:0;this._array.splice(c,0,a)}else this._array.push(a);this.map[a]=b,this._array.sort(function(a,b){return a-b})}},a.prototype.indexOf=function(a){for(var b in this.map)if(this.map.hasOwnProperty(b)&&this.map[b]===a)return Number(b)},a.prototype.push=function(a){var b=this._array[this._array.length-1]+1||0;this._array.push(b),this.map[b]=a,this._array.sort(function(a,b){return a-b})},a.prototype.remove=function(a){var b=this._array.indexOf(a);if(-1===b)throw new Error("key does not exist");this._array.splice(b,1),delete this.map[a]},a.prototype.get=function(a){return this.map[a]},a.prototype.getCount=function(){return this._array.length},a.prototype.forEach=function(a){for(var b,c,d=0;d<this._array.length;d++)b=this._array[d],c=this.map[b],a(c,b)},a.prototype.first=function(){var a,b;return a=this._array[0],b=this.map[a]};var b=function(){return new a};return b}).factory("scrollTo",function(){return function(a,b,c,d){a=$(a),"function"==typeof c&&2===arguments.length&&(d=c,c=b);var e=$.extend({scrollTarget:b,offsetTop:50,duration:500,easing:"swing"},c),f="number"==typeof e.scrollTarget?e.scrollTarget:$(e.scrollTarget),g="number"==typeof f?f:f.offset().top+a.scrollTop()-parseInt(e.offsetTop,10);a.animate({scrollTop:g},parseInt(e.duration,10),e.easing,function(){"function"==typeof d&&d.call(this)})}})}(window,document);