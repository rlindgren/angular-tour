!function(){"use strict";angular.module("angular-tour",["angular-tour.tpls","angular-tour.tour"]),angular.module("angular-tour.tpls",["tour/tour.tpl.html"]),angular.module("tour/tour.tpl.html",[]).run(["$templateCache",function(a){a.put("tour/tour.tpl.html",'<div class="tour-tip">\n    <span class="tour-arrow tt-{{ ttPlacement }}"></span>\n    <div class="tour-content-wrapper">\n        <p ng-bind-html="ttContent"></p>\n        <a ng-click="setCurrentStep(getCurrentStep() + 1)" ng-bind-html="ttNextLabel" class="small button tour-next-tip"></a>\n        <a ng-click="closeTour()" class="tour-close-tip">Ã—</a>\n    </div>\n</div>\n')}]),angular.module("angular-tour.tour",[]).constant("tourConfig",{placement:"top",animation:!0,nextLabel:"Next",scrollSpeed:500,offset:28,frame:"html,body"}).controller("TourController",["$scope","$state","orderedList",function(a,b,c){var d=this;d.postTourCallback=angular.noop,d.postStepCallback=angular.noop,d.currentStep=0,a.$on("$stateChangeSuccess",function(){d.currentStep=0,d[b.current.name]={},d[b.current.name].steps=c(),a.closeTour()}),d.select=function(a){if(angular.isNumber(a)){d.unselectAllSteps();var c=d[b.current.name].steps.get(a);c&&(c.ttOpen=!0),d.currentStep!==a&&(d.currentStep=a),a>=d[b.current.name].steps.getCount()&&d.postTourCallback(),d.postStepCallback()}},d.addStep=function(a){angular.isNumber(a.index)&&!isNaN(a.index)?d[b.current.name].steps.set(a.index,a):d[b.current.name].steps.push(a)},d.unselectAllSteps=function(){d[b.current.name].steps.forEach(function(a){a.ttOpen=!1})},d.cancelTour=function(){d.unselectAllSteps(),d.postTourCallback()},a.openTour=function(){d.select(0)},a.closeTour=function(){d.cancelTour()}}]).directive("tour",["$parse","$rootScope",function(a,b){return{controller:"TourController",restrict:"EA",scope:!0,link:function(c,d,e,f){if(!angular.isDefined(e.step))throw"The <tour> directive requires a `step` attribute to bind the current step to.";var g=a(e.step);c.$watch(e.step,function(a){f.currentStep=a}),f.postTourCallback=function(){angular.isDefined(e.postTour)&&c.$parent.$eval(e.postTour)},f.postStepCallback=function(){angular.isDefined(e.postStep)&&c.$parent.$eval(e.postStep)},c.setCurrentStep=function(a){g.assign(c.$parent,a),f.currentStep=a,f.select(f.currentStep),b.$broadcast("$tour:nextStep"+(a-1))},c.getCurrentStep=function(){return f.currentStep}}}}]).directive("tourtip",["$window","$compile","$interpolate","$parse","$timeout","scrollTo","tourConfig",function(a,b,c,d,e,f,g){var h=(c.startSymbol(),c.endSymbol(),"<div tour-popup></div>");return{require:"^tour",restrict:"EA",scope:!0,compile:function(c,i){var j=i.tourtipStep;return{pre:function(a,b,c,e){c.$observe("tourtip",function(b){a.ttContent=b}),c.$observe("tourtipPlacement",function(b){a.ttPlacement=b||g.placement}),c.$observe("tourtipNextLabel",function(b){a.ttNextLabel=b||g.nextLabel}),c.$observe("tourtipOffset",function(b){a.ttOffset=parseInt(b,10)||g.offset}),c.$observe("tourtipFrame",function(b){a.ttFrame=b||g.frame}),c.$observe("postStep",function(b){a.ttPostStep=b?d(b):angular.noop}),a.ttOpen=!1,a.ttAnimation=g.animation,a.index=parseInt(c.tourtipStep,10),e.addStep(a),a.$on("$stateChangeStart",function(){e.addStep(a)})},post:function(c,d){function i(){var b;c.ttContent&&(c.ttAnimation?l.fadeIn():l.css({display:"block"}),$("body").append(l),b=d.children().eq(0).length>0?d.children().eq(0):d,angular.element(a).bind("resize."+c.$id,function(){m(b,l)}),$(c.ttFrame).bind("scroll",function(){m(b,l)}),m(b,l),f(l,-200,-100,g.scrollSpeed,c.ttFrame))}function k(){l.detach(),angular.element(a).unbind("resize."+c.$id),$(c.ttFrame).unbind("scroll",m)}var l=b(h)(c);e(function(){c.$watch("ttOpen",function(a){a?i():k()})},500);var m=function(a,b){var d,e,f,g,h,i,j;switch(d=a[0].getBoundingClientRect(),e=b.width(),f=b.height(),i=a.width(),h=a.height(),j=28,c.ttPlacement){case"right":g={top:d.top-(f>h?j:0),left:d.left+i+c.ttOffset};break;case"bottom":g={top:d.top+h+c.ttOffset,left:d.left};break;case"left":g={top:d.top-(f>h?j:0),left:d.left-e-c.ttOffset};break;default:g={top:d.top-f-c.ttOffset,left:d.left}}g.top+="px",g.left+="px",b.css(g)};c.$on("$destroy",function(){angular.element(a).unbind("resize."+c.$id),$(c.ttFrame).unbind("scroll",m),l.remove()}),c.$on("$tour:nextStep"+j,function(){c.ttPostStep(c.$parent)&&c.ttPostStep(c.$parent)()})}}}}}]).directive("tourPopup",function(){return{replace:!0,templateUrl:"tour/tour.tpl.html",scope:!0,restrict:"EA",link:function(){}}}).factory("orderedList",function(){var a=function(){this.map={},this._array=[]};a.prototype.set=function(a,b){if(angular.isNumber(a))if(a in this.map)this.map[a]=b;else{if(a<this._array.length){var c=a-1>0?a-1:0;this._array.splice(c,0,a)}else this._array.push(a);this.map[a]=b,this._array.sort(function(a,b){return a-b})}},a.prototype.indexOf=function(a){for(var b in this.map)if(this.map.hasOwnProperty(b)&&this.map[b]===a)return Number(b)},a.prototype.push=function(a){var b=this._array[this._array.length-1]+1||0;this._array.push(b),this.map[b]=a,this._array.sort(function(a,b){return a-b})},a.prototype.remove=function(a){var b=this._array.indexOf(a);if(-1===b)throw new Error("key does not exist");this._array.splice(b,1),delete this.map[a]},a.prototype.get=function(a){return this.map[a]},a.prototype.getCount=function(){return this._array.length},a.prototype.forEach=function(a){for(var b,c,d=0;d<this._array.length;d++)b=this._array[d],c=this.map[b],a(c,b)},a.prototype.first=function(){var a,b;return a=this._array[0],b=this.map[a]};var b=function(){return new a};return b}).factory("scrollTo",function(){return function(a,b,c,d,e){a?(b=b||-100,c=c||-100,d=d||500,$(e).stop().animate({scrollTop:a.offset().top+b,scrollLeft:a.offset().left+c},d)):$(e).stop().animate({scrollTop:0},d)}})}(window,document);